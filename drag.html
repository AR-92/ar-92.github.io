<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Alpine.js Sortable Drag and Drop List</title>
    <script src="./alpine.js" defer></script>
  </head>
  <body x-data="sortable123">
    <div>
      <h1>Sortable List</h1>
      <ul>
        <template x-for="(item, index) in items" :key="index">
          <li
            class="cursor-move"
            x-bind:class="{ 'bg-gray-200': dragging === index }"
            draggable="true"
            @dragstart="dragging = index"
            @dragend="dragging = null"
            @dragover.prevent="dragging !== null && dragover(index)"
            @drop="dragging !== null && drop(index)"
          >
            <span x-text="item.name"></span>
            <span x-text="'........past'"></span>
          </li>
        </template>
      </ul>
    </div>

    <script>
      function moveArrayItem(array, fromIndex, toIndex) {
        const item = array.splice(fromIndex, 1)[0];
        array.splice(toIndex, 0, item);
      }
      document.addEventListener("alpine:init", () => {
        Alpine.data("sortable123", () => ({
          items: [
            { name: "item 1", c: [] },
            { name: "item 2", c: [] },
            { name: "item 3", c: [] },
          ],
          //   items: ["Item 1", "Item 2", "Item 3", "Item 4"],
          dragging: null,
          dragover(index) {
            if (this.dragging !== null) {
              moveArrayItem(this.items, this.dragging, index);
              this.dragging = index;
            }
          },
          drop(index) {
            if (this.dragging !== null) {
              moveArrayItem(this.items, this.dragging, index);
              this.dragging = null;
            }
          },
        }));
      });
    </script>
  </body>
</html>
